# Company Structure Visualizer


An interactive web application to visualize complex company ownership structures from an XLSX file. The application is built with a Vue.js frontend and a FastAPI backend, designed for a seamless development experience with Vite and a robust production deployment.

## Features

-   **Browser-Based XLSX Parsing**: Upload and process spreadsheets directly in the browser without server-side file handling.
-   **Interactive Graph Visualization**: Uses Vue Flow to create a dynamic and explorable graph of company relationships.
-   **Client-Side Data Persistence**: Leverages Dexie.js (IndexedDB) to store uploaded data, allowing users to revisit their graphs later.
-   **Modern Development Experience**: Hot Module Replacement (HMR) powered by Vite for instant feedback during development.
-   **Clean Architecture**: A clear separation between the Vue.js frontend and the Python FastAPI backend.
-   **Production-Ready Build**: A simple build process that compiles the frontend into static assets served by FastAPI.

---

## Technology Stack

### Frontend

-   **Framework**: [Vue.js](https://vuejs.org/) 3 (with Composition API)
-   **Build Tool**: [Vite](https://vitejs.dev/)
-   **Styling**: [Tailwind CSS](https://tailwindcss.com/)
-   **Graph Visualization**: [Vue Flow](https://vueflow.dev/)
-   **Client-Side Database**: [Dexie.js](https://dexie.org/) (IndexedDB Wrapper)
-   **Package Manager**: [pnpm](https://pnpm.io/)

### Backend

-   **Framework**: [FastAPI](https://fastapi.tiangolo.com/)
-   **Server**: [Uvicorn](https://www.uvicorn.org/)
-   **Templating**: [Jinja2](https://jinja.palletsprojects.com/)

---

## Project Structure

The project is organized into a clean monorepo-style structure:

```
.
├── api/              # Contains the Python API logic (future use)
├── app.py            # Main FastAPI application
├── frontend/         # The Vue.js frontend application source code
│   ├── public/       # Static assets like favicon.ico
│   ├── src/          # Vue component source files
│   ├── package.json  # Frontend dependencies
│   └── vite.config.js# Vite configuration
├── static/           # Static files served by FastAPI
│   └── dist/         # Compiled frontend assets (generated by `pnpm run build`)
├── templates/        # Jinja2 templates for production
│   └── index.html    # The main HTML shell for the production app
└── requirements.txt  # Python dependencies
```

---

## Setup and Installation

### Prerequisites

-   [Node.js](https://nodejs.org/) (v18 or newer)
-   [pnpm](https://pnpm.io/installation)
-   [Python](https://www.python.org/) (v3.10 or newer)

### Installation Steps

1.  **Clone the repository:**
    ```bash
    git clone <your-repository-url>
    cd company_visualiser
    ```

2.  **Setup the Backend:**
    It's recommended to use a Python virtual environment.
    ```bash
    # Create a virtual environment
    python -m venv .venv

    # Activate it (Windows)
    .\.venv\Scripts\activate

    # Activate it (macOS/Linux)
    source .venv/bin/activate

    # Install Python dependencies
    pip install -r requirements.txt
    ```

3.  **Setup the Frontend:**
    Navigate to the `frontend` directory and install the Node.js dependencies.
    ```bash
    cd frontend
    pnpm install
    ```

---

## Running the Application

The application can be run in two modes: **development** (for coding and testing) and **production** (simulating a deployed environment).

### Development Mode

For the best development experience, run the backend and frontend servers in two separate terminals.

**Terminal 1: Start the FastAPI Backend**
(From the project root directory)
```bash
uvicorn app:app --reload --port 8000
```
The backend will be running at `http://localhost:8000`.

**Terminal 2: Start the Vite Frontend Dev Server**
(From the project root directory)
```bash
cd frontend
pnpm run dev
```
The Vite server will start, typically at `http://localhost:5174`. **Open this URL in your browser.** The frontend will automatically proxy any API requests to the FastAPI backend.

### Production Mode

This mode simulates how the application would run when deployed. It uses the compiled frontend assets served by the Python server.

1.  **Build the Frontend Assets:**
    First, build the optimized frontend files.
    (From the `frontend` directory)
    ```bash
    pnpm run build
    ```
    This command will place the compiled JS, CSS, and other assets into the `static/dist` directory and move the final `index.html` to the `templates` directory.

2.  **Run the FastAPI Server:**
    Now, start the FastAPI server, which will serve the complete application.
    (From the project root directory)
    ```bash
    uvicorn app:app --host 0.0.0.0 --port 8000
    ```
    Open `http://localhost:8000` in your browser.

---

## Usage

1.  Open the application in your browser.
2.  Click the **"Upload XLSX"** button.
3.  Select an Excel file that contains two sheets:
    -   A **"Companies"** sheet with `Company Name` and `Company Number` columns.
    -   An **"Ownership"** sheet with `Owner`, `Owns`, and `Percentage Ownership` columns.
4.  The application will parse the file and render the ownership structure as an interactive graph.
5.  The data is saved in your browser's local database, so the graph will be reloaded the next time you visit the page.

### Clearing Local Data

The application uses your browser's IndexedDB to store data. If you need to clear it, you can do so using your browser's developer tools:
1.  Press `F12` to open Developer Tools.
2.  Go to the **Application** tab.
3.  Find **IndexedDB** in the sidebar.
4.  Right-click on the `CompanyVisualizerDB` database and select "Delete database".

---

## License
